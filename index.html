<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta content="width=device-width, initial-scale=1" name="viewport"/>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>TGISViewer Version 2.00</title>
  <script src="assets/global/plugins/jquery-3.2.1.min.js"></script>
  <link rel="stylesheet" href="assets/global/plugins/bootstrap/css/bootstrap.css">
  <script src="assets/global/plugins/bootstrap/js/bootstrap.js"></script>
  <!--<link rel="stylesheet" href="assets/global/plugins/bootstrap-fileinput/css/fileinput.css">-->
  <!--<script src="assets/global/plugins/bootstrap-fileinput/js/fileinput.js"></script>-->
  <!-- BEGIN GLOBAL MANDATORY STYLES -->
  <link href="assets/global/plugins/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css"/>
  <!--<link href="assets/global/plugins/simple-line-icons/simple-line-icons.min.css" rel="stylesheet" type="text/css"/>-->
  <!--<link href="assets/global/plugins/bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css"/>-->
  <!-- END GLOBAL MANDATORY STYLES -->
  <!-- BEGIN PAGE LEVEL PLUGINS -->
  <!--<link href="assets/global/plugins/bootstrap-select/css/bootstrap-select.css" rel="stylesheet" type="text/css"/>-->
  <!--<link href="assets/global/plugins/bootstrap-tabdrop/css/tabdrop.css" rel="stylesheet" type="text/css"/>-->
  <!-- END PAGE LEVEL PLUGINS -->
  <!-- BEGIN THEME GLOBAL STYLES -->
  <link href="assets/global/css/components.css" rel="stylesheet" type="text/css"/>
  <link href="assets/global/css/plugins.css" rel="stylesheet" type="text/css"/>
  <!-- END THEME GLOBAL STYLES -->
  <!-- BEGIN THEME LAYOUT STYLES -->
  <link href="assets/layouts/css/layout.css" rel="stylesheet" type="text/css"/>
  <!--<link href="assets/layouts/css/themes/darkblue.css" rel="stylesheet" type="text/css" id="style_color"/>-->
  <link href="assets/layouts/css/custom.css" rel="stylesheet" type="text/css"/>
  <!-- END THEME LAYOUT STYLES -->



  <style type="text/css">
    body, html {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
      overflow: hidden;
    }

    #mapContainer {
      width: 100%;
      height: 100%;
      margin: 0;
      padding: 0;
    }

    #testButtons {
      position: absolute;
      right: 20px;
      top: 20px;
      width: 200px;
      height: 30px;
      z-index: 999;
      background: #ffffff;
      color: #777777;
      padding: 5px;
      border: 2px solid #666666;
      -webkit-border-radius: 5px;
      -moz-border-radius: 5px;
      border-radius: 5px;
      font-size: 12px;
    }
  </style>

</head>
<body class="claro">

<div id="mapContainer">

</div>


<div id="testButtons">
  <button type="button" onclick="Test1ClickHandler()">Test1</button>
  <button type="button" onclick="Test2ClickHandler()">Test2</button>
  <button type="button" onclick="Test3ClickHandler()">Test3</button>
</div>
<script type="text/javascript" src="TGISAPI.js"></script>
<!--<script type="text/javascript" src="libs/EChartsInArcGIS.js"></script>-->

<script type="text/javascript">
  var map = TMap.createNew({
    apiUrl: "http://localhost:8090/arcgis_js_api/library/3.22/3.22/",
    // apiUrl: "http://172.1.1.102:18001/web-gis/scripts/arcgis_js_api/library/3.20/3.20/",
    viewerUrl: "http://localhost:8090/TGISViewer_v200/",
    // viewerUrl: "http://172.1.1.102:18001/web-gis/scripts/TGISViewer2",
    // config: "http://localhost:8090/TGISViewer_v200/project/JiaoWei/外网172.16.0.2/config.json"
    // config: "http://localhost:8090/TGISViewer_v200/project/JiaoWei/内网128.64.151.238/config.json"
    // config: "http://localhost:8090/TGISViewer_v200/project/JiaoWei/政务网172.1.1.101/config.json"
    // config: "http://localhost:8090/TGISViewer_v200/project/ShuangLiu/config-route-www.json"
    config: "http://localhost:8090/TGISViewer_v200/project/ShangHaiHarbour/config.json"
    // config: "http://172.1.1.102:18001/web-gis/scripts/TGISViewer2/config.json"
  }, "mapContainer", function () {
    // map.showDynamicRendererLayer({
    //   name: "IssuesectState",
    //   defaultData: "free",
    //   datas: [
    //     {id: "FBD_27", data: "crowd"},
    //     {id: "FBD_28", data: "crowd"},
    //     {id: "FBD_29",data: "jam"},
    //     {id: "FBD_30", data: "jam"}
    //   ]
    // });
    // map.showDynamicRendererLayer({
    //   name: "AccidentsNumber",
    //   defaultData: 40,
    //   datas: [
    //     {id: "B11", data: 22},
    //     {id: "B13", data: 98},
    //     {id: "B15",data: 46},
    //     {id: "B12",data: 9},
    //     {id: "B14", data: 19}
    //   ]
    // });
//      map.setMapCenter({x: 0, y: 0});
//      map.closeWidget("TopToolbarWidget");
//      map.showLayer({label: "道路交通设施", ids: [33, 34]});

//      map.startSwipe({
//        swipeType: "vertical",
//        referenceLayers: [
//          {
//            label: "水运交通设施",
//            ids: [18]
//          }
//        ],
//        swipeLayers: [
//          {
//            label: "规划航道",
//            ids: [0]
//          }
//        ]
//      });
//      map.showLayer({label: "道路交通设施", ids: [32]});
//      map.showLayer({label: "行政区人口密度"});
//      map.hideLayer({label: "行政区人口总量"});
//      map.showLayer({label: "黄浦江桥梁流量"});
//      map.showLayer({label: "黄浦江隧道流量"});
//      map.hideLayer({label: "苏州河桥梁流量"});
//      map.hideLayer({label: "苏州河隧道流量"});
//      map.showLayer({label: "岸线"});
//      map.showRailwayStationFlow({flows: [{name: "上海南站", in: 12384, out: 29384}, {name: "上海西站", in: 2932, out: 298}, {name: "上海虹桥站", in: 239874, out: 987364}, {name: "上海站", in: 873978, out: 298479}]});
//      map.addOverlays('{"showPopup":true,"defaultButtons":[{"label":"确认报警","type":"confirmAlarm"},{"label":"详情","type":"alarmDesc"}],"defaultSymbol":{"type":"esriPMS","url":"http://static.arcgis.com/images/Symbols/Basic/RedBeacon.png","width":24,"height":24},"overlays":[{"type":"sxj","id":"cam001","geometry":{"x":103.913,"y":30.590},"fields":{"编号":"","位置描述":"","路口路段":"","辖区名称":"","车牌号":""}}]}');
//      map.addOverlays('{"showPopup":true,"defaultButtons":[{"label":"确认报警","type":"confirmAlarm"},{"label":"详情","type":"alarmDesc"}],"defaultSymbol":{"type":"esriPMS","url":"http://static.arcgis.com/images/Symbols/Basic/RedBeacon.png","width":24,"height":24},"overlays":[{"type":"sxj","id":"cam001","geometry":{"x":87.449,"y":43.492},"fields":{"编号":"","位置描述":"","路口路段":"","辖区名称":"","车牌号":""}}]}');
//      map.addPoints('{"points":[{"symbol":{"yoffset":13,"width":16,"type":"picture","url":"http://172.30.30.12:18001/web-gis/scripts/TGISViewer_v200/images/mapIcons/blue/0.png","height":19},"geometry":{"x":87.4235618296279,"y":43.474032926957},"id":"948ab669-f01f-4eba-90ad-2952533c8915,1","type":"SheBei","fields":{"zcpp":"","hostname":"暂无设备名","issue":"未绑定监控","level":"blue/0.png-2","zcms":"资产描述","zcmc":"资产显示名称","zcbh":"T000001","gzsj":null,"levelMessage":"暂无异常"}}]}');
//     map.addPoints('{"points":[{"id":"1400","type":"dutyPolice","geometry":{"x":117.75,"y":39.124},"symbol":{"type":"picture","url":"images/mapIcons/JingCha-blue.png","height":26,"width":22,"yoffset":13}}]}');
//      map.startTrackPlayback({trackPoints:[{x: 104.023, y: 30.577, time: ""}, {x: 104.002, y: 30.565, time: ""}, {x: 103.969, y: 30.56, time: ""}, {x: 103.907, y: 30.536, time: ""}]});

    // map.setBusLineFlow({"flows":[{"lineName":"46路","flow":32572},{"lineName":"110路","flow":26783},{"lineName":"21路","flow":26394},{"lineName":"66路","flow":26304},{"lineName":"25路","flow":26252},{"lineName":null,"flow":24570},{"lineName":"94路","flow":23830},{"lineName":"112路","flow":23178},{"lineName":"23路","flow":19804},{"lineName":"44路","flow":19797},{"lineName":"116路","flow":18979},{"lineName":"55路","flow":18933},{"lineName":"63路","flow":18890},{"lineName":"6路","flow":18813},{"lineName":"92路B线","flow":18300},{"lineName":"89路","flow":18075},{"lineName":"13路","flow":18061},{"lineName":"28路","flow":17493},{"lineName":"91路","flow":17431},{"lineName":"67路","flow":17325},{"lineName":"156路","flow":16762},{"lineName":"141路","flow":16413},{"lineName":"90路","flow":16347},{"lineName":"37路","flow":16239},{"lineName":"45路","flow":16226},{"lineName":"50路区间","flow":15914},{"lineName":"64路","flow":15654},{"lineName":"41路","flow":15510},{"lineName":"135路","flow":15363},{"lineName":"85路","flow":15267},{"lineName":"18路","flow":15249},{"lineName":"76路","flow":15200},{"lineName":"78路","flow":15173},{"lineName":"56路","flow":14692},{"lineName":"95路","flow":14689},{"lineName":"118路","flow":14669},{"lineName":"49路","flow":14352},{"lineName":"88路","flow":14322},{"lineName":"59路","flow":14054},{"lineName":"123路","flow":13741},{"lineName":"20路","flow":13625},{"lineName":"19路","flow":13548},{"lineName":"54路","flow":13288},{"lineName":"700路","flow":12945},{"lineName":null,"flow":12827},{"lineName":"61路","flow":12771},{"lineName":"58路","flow":12758},{"lineName":"115路","flow":12752},{"lineName":"24路","flow":12738},{"lineName":"96路","flow":12661},{"lineName":"40路","flow":12646}]});
    // map.setMetroLineFlow({"flows":[{"lineName":"轨道交通2号线","flow":1629459},{"lineName":"轨道交通3号线","flow":562404},{"lineName":"轨道交通4号线","flow":880504},{"lineName":"轨道交通5号线","flow":153021},{"lineName":"轨道交通6号线","flow":467235},{"lineName":"轨道交通7号线","flow":852138},{"lineName":"轨道交通8号线","flow":1068409},{"lineName":"轨道交通9号线","flow":963229},{"lineName":"轨道交通10号线","flow":877611},{"lineName":"轨道交通11号线","flow":895319},{"lineName":"轨道交通12号线","flow":709396},{"lineName":"轨道交通13号线","flow":467170},{"lineName":"轨道交通16号线","flow":197220}]})
    // map.showDoubleMap();
    // map.showOD({type: "O", startID: "B11", endFlows: [{ID: "B12", flow: 100},{ID: "B13", flow: 150},{ID: "B14", flow: 200},{ID: "B15", flow: 250},{ID: "B17", flow: 300},{ID: "B18", flow: 350}]});
    map.hideTopToolbarButton("图形搜索");
    map.hideTopToolbarButton("输入坐标");
    map.hideTopToolbarButton("矢量图");
    map.hideTopToolbarButton("航拍图");
    map.hideTopToolbarButton("线划图");
    map.hideTopToolbarButton("对比");
    map.hideTopToolbarButton("历史演变");

    // map.startDrawOverlay({drawType:"point"}, function (result) {
    //   console.log(result.x, result.y);
    // });
  });

  function Test1ClickHandler() {
//      map.showLayer({label: "道路", ids: [3]});
//      map.showLayer({label: "十三五公交枢纽", ids: [0]});
//      map.showLayer({label: "公交专用道", ids: [0,1]});
//      map.showLayer({label: "内河港区"});
//      map.convertCAD({
//        cadFileName: "test.dwg",
//        projectName: "project333",
//        projectState: "constructing"
//      }, function (result) {
//        console.log(result);
//      });

//      map.openWidget("DrawWidget");

//      map.showLayer({label: "地形图"});
//      map.showLayer({label: "内河港区"});
//      map.addLayer({label: "111", url: "http://128.64.151.222:6080/arcgis/rest/services/CADServices/project222_constructing/MapServer"});
//      map.addLayer({label: "wmsTest", url: "http://172.16.20.2:8090/iserver/services/map-Data010/wms111/test2", type: "wms"});
//      map.addLayer({type: "ChengDiDynamic", url: "16070555523454", label: "cad111"});

     // map.addLines('{"lines":[{"id":"wx001","geometry":{"paths":[[[-5699, -3025],[-4937, -2720],[-1685, -1112]]]},"symbol":{"style":"solid","color":"#00FF00","alpha": 0.5, "width":8}}]}');

//      map.geometrySearch({drawType: "polygon"});
//      map.addSwipeLayer({layerType: "swipe", layer: {label: "db1", url: "http://172.16.20.2:6080/arcgis/rest/services/CADServices/p20170725110633_c20170725110633/MapServer"}})

//      map.setMapCenter({x: 1702, y: -23821});
//      map.setMapScale(8000);
//      map.setMapLevel(1);
//      map.setMapCenterAndLevel({x: 1702, y: -23821, level: 1});
//      map.addPoints('{"points":[{"id":"pt001","type":"QBB","geometry":{"x":-5699,"y":-3025},"fields":{"DEVSTATE":"connect"},"symbol":{"type":"marker","size":12,"color":"#FF0000","alpha":0.5,"outline":{"color":"#FFFFFF","width":2}}},{"id":"pt002","type":"QBB","geometry":{"x":121.467,"y":31.222},"fields":{"DEVSTATE":"disconnect"},"symbol":{"type":"picture","url":"images/mapIcons/ChuZuChe.png","width":24,"height":35,"yoffset":17.5}},{"id":"pt003","type":"QBB","geometry":{"x":121.456,"y":31.262},"fields":{"DEVSTATE":"connect"},"symbol":{"type":"marker","color":"#FFFF00"}},{"id":"pt004","type":"QBB","geometry":{"x":121.443,"y":31.229},"fields":{"DEVSTATE":"unknown"},"symbol":{"type":"marker","color":"#0000FF"}}]}');

//      map.findFeature({layerName: "道路搜索", ids: ["29786","30041", "30186", "30187", "30188", "30189", "30190", "30488", "30536", "30537", "30061", "30062", "30540", "30644", "30645", "30646"]});
//      map.findFeature({layerName: "行政区人口密度", ids: ["310104"]});
//      map.searchRoad({where: [{field: "district",value: ["金山区", "奉贤区"]}, {field: "tLevel",value: ["一级"]}]});
//      map.searchRoad({where: [{field: "district",value: ["金山区", "奉贤区"]}, {field: "aLevel",value: ["G", "S"]}]}, function (results) {
//      map.searchRoad({where: [{field: "tLevel",value: ["高速"]}]}, function (results) {
//        console.log(results);
//        for (var i = 0; i < results.length; i++) {
//          console.log(results[i].name, results[i].id, results[i].district, results[i].length);
//        }
//      });
//      map.searchRoad({where: [{field: "name",value: ["中山"]}]}, function (results) {
//        console.log(results);
//      });
//      map.searchRoad({where: [{field: "material",value: ["沥混"]}]}, function (results) {
//        console.log(results);
//      });
//      map.searchRoad({where: [{field: "cLevel",value: ["主干路"]}, {field: "ringRegion", value: ["inInner", "betweenInnerAndMiddle"]}]}, function (result) {
//        console.log(result);
//      });


//      map.hideLayer({label: "行政区人口密度"});
//      map.showLayer({label: "行政区人口总量"});
//      map.hideLayer({label: "黄浦江桥梁流量"});
//      map.hideLayer({label: "黄浦江隧道流量"});
//      map.showLayer({label: "苏州河桥梁流量"});
//      map.showLayer({label: "苏州河隧道流量"});

//      map.getOverlays({clearOverlays: true}, function (results) {
//        console.log(JSON.stringify(results));
//      });

//      map.multiSearch({text: "武宁路"}, function (results) {
//        console.log(results);
//
//        map.getMultiSearchResult({className: "road", maxCount: 1000}, function (results) {
//          console.log(results);
//        });
//
//        map.showMultiSearchResult({featureIds: ["道路_0","道路_1","道路_2","道路_3","道路_4","道路_5","道路_6","道路_7"]});
//      });

    // map.deleteOverlays({types: ["CADPile"]});

    // map.hideLayer({label: "地面实时指数"});
    // map.hideLayer({label: "快速路实时指数"});
    //
    // map.showDynamicRendererLayer({
    //   name: "IssuesectSpeed",
    //   defaultData: "40",
    //   datas: [
    //     {id: "NHZSB-WO->NHD&Y-WI", data: "10"},
    //     {id: "HMHM-DO->HMHM-DI", data: "10"},
    //     {id: "NBYC-DO->NBGZ-DI",data: "10"},
    //     {id: "YIXYG-XI->YIXCZ-XO", data: "10"}
    //   ]
    // });

    // map.showDynamicRendererLayer({
    //   name: "AccidentsNumber",
    //   defaultData: 40,
    //   datas: [
    //     {id: "B11", data: 22},
    //     {id: "B13", data: 98},
    //     {id: "B15",data: 46},
    //     {id: "B12",data: 9},
    //     {id: "B14", data: 19}
    //   ]
    // });
    // map.addOverlays('{"showPopup":true,"defaultButtons":[{"label":"确认报警","type":"confirmAlarm"},{"label":"详情","type":"alarmDesc"}],"defaultSymbol":{"type":"esriPMS","url":"http://static.arcgis.com/images/Symbols/Basic/RedBeacon.png","width":24,"height":24},"overlays":[{"type":"sxj","id":"cam001","geometry":{"x":103.913,"y":30.590},"fields":{"编号":"","位置描述":"","路口路段":"","辖区名称":"","车牌号":""}}]}');
    // map.addPolygons('{"polygons":[{"geometry":{"rings":[[[-1984.3789687579374,1680.1075268817203],[-1984.3789687579374,3188.2355431377528],[291.04224875116415,3188.2355431377528],[291.04224875116415,1680.1075268817203],[-1984.3789687579374,1680.1075268817203]]]},"symbol":{"color":[155,187,89],"alpha":0.5,"outline":{"color":[115,140,61],"width":1.5,"type":"esriSLS","style":"esriSLSSolid","marker":null},"type":"esriSFS","style":"esriSFSSolid"}}]}');
    // map.startTrackPlayback('{"trackPoints":[{"x":103.939408,"y":30.588302,"id":"44dd066868f34325adc02a12eec7d1b1","fields":{"经过时间":"2018-01-24 10:00:15"}},{"x":103.938403,"y":30.587602,"id":"1f5d52e50b2542a89c406af13a9a3b17","fields":{"经过时间":"2018-01-24 10:01:35"}},{"x":103.938138,"y":30.587438,"id":"1cb0d7b02ddf4c1282ce659e9965a591","fields":{"经过时间":"2018-01-24 10:01:55"}},{"x":103.937773,"y":30.587165,"id":"a793d76b9c9b40d484b642dc0fb1eb91","fields":{"经过时间":"2018-01-24 10:02:15"}},{"x":103.93666,"y":30.586398,"id":"fe4fd140bcc64583b57ab7ed6e441097","fields":{"经过时间":"2018-01-24 10:02:45"}},{"x":103.93478,"y":30.585057,"id":"999519fa08d5415fa5a123176d76a009","fields":{"经过时间":"2018-01-24 10:03:15"}},{"x":103.933555,"y":30.58419,"id":"80107d8bbf594bde93da419cb4099439","fields":{"经过时间":"2018-01-24 10:03:35"}},{"x":103.932997,"y":30.583838,"id":"1af52c3460fd4af4acbdcff6dfa43ca3","fields":{"经过时间":"2018-01-24 10:04:05"}},{"x":103.93177,"y":30.582902,"id":"78e0e2605b8a4e6499334325153bcdc5","fields":{"经过时间":"2018-01-24 10:04:25"}},{"x":103.929671,"y":30.58124,"id":"2fde6bce763c46c7ae02437483f4b3fd","fields":{"经过时间":"2018-01-24 10:04:55"}},{"x":103.928785,"y":30.580431,"id":"5a51d90902804c45b2f5b80b34a87fa3","fields":{"经过时间":"2018-01-24 10:05:25"}},{"x":103.927802,"y":30.578882,"id":"347c7c3cccd44301a45e821a301d2da3","fields":{"经过时间":"2018-01-24 10:05:45"}},{"x":103.927156,"y":30.578426,"id":"9e56aa4504e34f6699bab9e1e491c521","fields":{"经过时间":"2018-01-24 10:06:15"}},{"x":103.926713,"y":30.577883,"id":"c2c271ffceb2456dbad8f7a63a820655","fields":{"经过时间":"2018-01-24 10:06:35"}},{"x":103.927173,"y":30.57715,"id":"ce4ae456fc7a4ead9addd47ec8288c11","fields":{"经过时间":"2018-01-24 10:07:05"}},{"x":103.928352,"y":30.576328,"id":"611efb9590364ed0a63e335b1e10ccbc","fields":{"经过时间":"2018-01-24 10:07:25"}},{"x":103.92904,"y":30.575808,"id":"7c3d05b1bf7d4243916d75534c11b3a7","fields":{"经过时间":"2018-01-24 10:07:55"}},{"x":103.929443,"y":30.575508,"id":"cb60f035be6648ab96c57673b87bf26f","fields":{"经过时间":"2018-01-24 10:08:25"}},{"x":103.929472,"y":30.575496,"id":"14f27be1781f4364a7bb716797d47998","fields":{"经过时间":"2018-01-24 10:08:55"}},{"x":103.929486,"y":30.575502,"id":"9aa960f7e9c845749c392eff242c2325","fields":{"经过时间":"2018-01-24 10:09:15"}},{"x":103.929496,"y":30.575498,"id":"ed57e73018de4bd49e29829bce498c91","fields":{"经过时间":"2018-01-24 10:09:45"}},{"x":103.929393,"y":30.575001,"id":"607b80ffa32b4c979e6d1b4bb3b42bac","fields":{"经过时间":"2018-01-24 10:10:15"}},{"x":103.929247,"y":30.574843,"id":"059a58a44abc42808341bf168d852809","fields":{"经过时间":"2018-01-24 10:10:35"}},{"x":103.927828,"y":30.573348,"id":"e0140aace1e34c228dbe926f4c79e7a8","fields":{"经过时间":"2018-01-24 10:11:05"}},{"x":103.926832,"y":30.572345,"id":"9f327a044c554b8c80cfa9529d1bfdba","fields":{"经过时间":"2018-01-24 10:11:35"}},{"x":103.926693,"y":30.57212,"id":"7e0135a0643643caa499c4b1579f1f8d","fields":{"经过时间":"2018-01-24 10:11:55"}},{"x":103.926181,"y":30.571833,"id":"25ab048cda8f4b0e9dfba9c5c9d608e0","fields":{"经过时间":"2018-01-24 10:12:25"}},{"x":103.925011,"y":30.570585,"id":"81d28e73cec54df6ad4dc0ef92b3af65","fields":{"经过时间":"2018-01-24 10:12:45"}},{"x":103.92338,"y":30.568935,"id":"b46c637c541a4f9488b23ba644ba01b3","fields":{"经过时间":"2018-01-24 10:13:15"}},{"x":103.9233,"y":30.568846,"id":"f86f3a3d0d95468bbf59e8fef3a5638a","fields":{"经过时间":"2018-01-24 10:13:35"}},{"x":103.923266,"y":30.568807,"id":"4be020b3ce774dc69deea7a9767e7d8e","fields":{"经过时间":"2018-01-24 10:14:05"}},{"x":103.92252,"y":30.568237,"id":"d2cf433d167848c981026c2f7c73e86c","fields":{"经过时间":"2018-01-24 10:14:35"}},{"x":103.921317,"y":30.567101,"id":"5c18284af5a8466aa447ede746d8c160","fields":{"经过时间":"2018-01-24 10:14:55"}},{"x":103.919691,"y":30.565241,"id":"33a1127f1b1d498599d429afb18531f1","fields":{"经过时间":"2018-01-24 10:15:25"}},{"x":103.920086,"y":30.564813,"id":"fcb4c26ee0324860b4484d8c5dc0cb92","fields":{"经过时间":"2018-01-24 10:15:45"}},{"x":103.921573,"y":30.563817,"id":"3e60f48e7a8c4ffa9fc1bca26a9cb3a6","fields":{"经过时间":"2018-01-24 10:16:15"}},{"x":103.921997,"y":30.563493,"id":"43a3ef0b1a6c4b68935e08d7edc2436c","fields":{"经过时间":"2018-01-24 10:16:35"}},{"x":103.922042,"y":30.563498,"id":"4200a9e01736496595168fae2342d570","fields":{"经过时间":"2018-01-24 10:17:05"}},{"x":103.922445,"y":30.56326,"id":"550c46c6b910410891aced38d4ada17a","fields":{"经过时间":"2018-01-24 10:17:35"}},{"x":103.922996,"y":30.562932,"id":"0be540c9dee04a03b95619d6d0891a49","fields":{"经过时间":"2018-01-24 10:17:55"}},{"x":103.923763,"y":30.562168,"id":"d4ab4fff3e13480b89797171a9129d32","fields":{"经过时间":"2018-01-24 10:18:25"}},{"x":103.924597,"y":30.561528,"id":"f5298c4ded874bd4b787178aad1f12d3","fields":{"经过时间":"2018-01-24 10:18:45"}},{"x":103.92467,"y":30.561471,"id":"f6f787f0efcd4f24b11fc7ef80065677","fields":{"经过时间":"2018-01-24 10:19:15"}},{"x":103.925283,"y":30.561058,"id":"86c645383ceb4b968330f941a91be5f9","fields":{"经过时间":"2018-01-24 10:19:45"}},{"x":103.925712,"y":30.560755,"id":"dbd1fd06907f4b6eb724e6414d33105b","fields":{"经过时间":"2018-01-24 10:20:05"}},{"x":103.925522,"y":30.560061,"id":"4940f450e2834a148b9370e3729c850a","fields":{"经过时间":"2018-01-24 10:20:35"}},{"x":103.92541,"y":30.559916,"id":"26f97491fa12434987f770d7b0722167","fields":{"经过时间":"2018-01-24 10:20:55"}},{"x":103.925127,"y":30.55973,"id":"d0393f3db9214d149e7e727a95ab1245","fields":{"经过时间":"2018-01-24 10:21:25"}},{"x":103.92511,"y":30.559743,"id":"edf3ac740b8a4cb795a6b15dfd768322","fields":{"经过时间":"2018-01-24 10:21:45"}},{"x":103.924796,"y":30.56002,"id":"02773bea6888465ba72e4f79de754add","fields":{"经过时间":"2018-01-24 10:22:15"}},{"x":103.923843,"y":30.559995,"id":"be030285741543c99a4511b3a680ba41","fields":{"经过时间":"2018-01-24 10:22:45"}},{"x":103.923962,"y":30.560288,"id":"c6a7f0b1304945d69af0950cd7fa9b77","fields":{"经过时间":"2018-01-24 10:23:05"}},{"x":103.923963,"y":30.560288,"id":"f1012533f3ea4a7d8caa8f66c717d519","fields":{"经过时间":"2018-01-24 10:25:15"}},{"x":103.923963,"y":30.560287,"id":"9b575cd949654d7a8d06826ad88c0d55","fields":{"经过时间":"2018-01-24 10:27:55"}}], "autoStart": true, "loop": false, "showTrackPoints": true}');

    // map.exportMap({}, function (url) {
    //   console.log(url);
    // });

    // map.addOverlays('{"showPopup":true,"defaultSymbol":{"type":"marker","style":"circle","color":"red","alpha":0.8,"size":8,"outline":{"color":"white"}},"overlays":[{"type":"CADPile","geometry":{"x":"-2306.4187","y":"3261.5966"},"fields":{"里程":"K0-2.082","点类型":"起点","标高":"3.94"},"symbol":{"type":"marker","style":"circle","color":"red","alpha":0.8,"size":12,"outline":{"color":"white"}}},{"type":"CADPile","geometry":{"x":"-2224.4326","y":"3313.7568"},"fields":{"里程":"K0+95.475","点类型":"圆缓点","标高":"4.03"}},{"type":"CADPile","geometry":{"x":"-2177.6508","y":"3331.3657"},"fields":{"里程":"K0+145.475","点类型":"","标高":"2.01"}}]}');

    // map.hideBottomToolbarButton("发布段");
    // map.hideBottomToolbarButton("摄像机");
    // map.hideTopToolbarButton("保存");

    // map.showDoubleMap();
    // map.addDoubleMapLayer({mapIndex: "1", label: "道路交通设施", ids: [27, 28]});
    // map.addDoubleMapLayer({mapIndex: "2", label: "cad111", type: "ChengDiDynamic", url: "154030125497999"});

    // map.showRouteByCross({crossIds:["51012211500109","51012200100102","51012200100112","51012200100123","51012200100134","51012212000438"]});

    // map.hideTopToolbar();
    // map.hideBottomToolbar();
    // map.findFeature({layerName: "AccidentsNumber", ids: ["B11"]});
    // map.showOD({type: "O", startID: "B12", endFlows: [{ID: "B11", flow: 100},{ID: "B13", flow: 150},{ID: "B14", flow: 200},{ID: "B15", flow: 250},{ID: "B17", flow: 300},{ID: "B18", flow: 350}]});

    // map.findFeature({layerName: "SheBei", ids: ["948ab669-f01f-4eba-90ad-2952533c8915,1"]});
  }


  function Test2ClickHandler() {
//      map.addSwipeLayer({layerType: "reference", layer: {label: "db2", url: "http://172.16.20.2:6080/arcgis/rest/services/CADServices/p20170725111146_c20170725111146/MapServer"}})
//      map.stopSwipe();
//      map.removeSwipeLayer({
//        layerType: "reference",
//        layer: {label: "道路", ids: [6]}
//      });

//      map.closeWidget("DrawWidget");
//      map.hideLayer({label: "航道"});
//      map.removeLayer({label: "111", url: "http://128.64.151.222:6080/arcgis/rest/services/CADServices/project222_constructing/MapServer"});

//      map.deleteLines(["wx001"]);

     map.deleteAllPoints();

//      map.findFeature({layerName: "searchRoad", names: ["中山北二路"], showResult: true, centerResult: true});
//      map.addPolygons('{"polygons":[{"geometry":{"rings":[[[-1984.3789687579374,1680.1075268817203],[-1984.3789687579374,3188.2355431377528],[291.04224875116415,3188.2355431377528],[291.04224875116415,1680.1075268817203],[-1984.3789687579374,1680.1075268817203]]]},"symbol":{"color":[155,187,89],"alpha":0.5,"outline":{"color":[115,140,61],"width":1.5,"type":"esriSLS","style":"esriSLSSolid","marker":null},"type":"esriSFS","style":"esriSFSSolid"}}]}');
//      map.addOverlays('{"overlays":[{"geometry":{"rings":[[[-4471.467276267886,-846.6683600033866],[-132.29193125052916,-1693.3367200067732],[-582.0844975023283,-3915.841165015665],[-5027.093387520108,-4762.509525019052],[-7990.432647531961,-1640.4199475065616],[-4471.467276267886,-846.6683600033866]]]},"symbol":{"color":[155,187,89,128],"outline":{"color":[115,140,61,255],"width":1.5,"type":"esriSLS","style":"esriSLSSolid","marker":null},"type":"esriSFS","style":"esriSFSSolid"}},{"geometry":{"paths":[[[5132.926932520535,-343.9590212513758],[4815.426297519265,-370.41740750148165],[3016.2560325120685,-1084.793836254339],[2381.2547625095285,-1455.2112437558208],[2222.5044450088935,-1957.9205825078316],[2407.7131487596344,-2540.00508001016],[3095.631191262386,-3227.9231225129115],[4206.883413766831,-3889.382778765559],[4762.509525019053,-4524.384048768099],[4788.967911269159,-5000.635001270004],[4550.842435018207,-5397.510795021592],[3095.631191262386,-5794.386588773179],[1428.7528575057186,-6058.970451274237],[1217.085767504872,-6058.970451274237]]]},"symbol":{"color":[79,129,189,255],"width":6.75,"type":"esriSLS","style":"esriSLSSolid","marker":null}}]}');
//      map.addOverlays('{"overlays":[{"type":"sxj","id":"cam001","geometry":{"x":-264.5838,"y":-978.9602},"symbol":{"type":"esriPMS","url":"http://static.arcgis.com/images/Symbols/Basic/RedBeacon.png","width":24,"height":24}}]}');
//      map.addOverlays('{"showPopup":true,"defaultButtons":[{"label":"确认报警","type":"confirmAlarm"},{"label":"详情","type":"alarmDesc"}],"defaultSymbol":{"type":"esriPMS","url":"http://static.arcgis.com/images/Symbols/Basic/RedBeacon.png","width":24,"height":24},"overlays":[{"type":"sxj","id":"cam001","geometry":{"x":103.913,"y":30.590},"fields":{"编号":"","位置描述":"","路口路段":"","辖区名称":"","车牌号":""}}]}');
//      map.addOverlays('{"overlays":[{"type":"CADPile","geometry":{"x":-2306.4187,"y":3261.5966},"symbol":{"type":"marker","style":"circle","color":[255,128,128],"size":12},"fields":{"里程":"K0-2.082","点类型":"起点","标高":3.94}},{"type":"CADPile","geometry":{"x":-2224.4326,"y":3313.7568},"symbol":{"type":"marker","style":"circle","color":[255,128,128],"size":12},"fields":{"里程":"K0+95.475","点类型":"圆缓点","标高":4.03}},{"type":"CADPile","geometry":{"x":-2177.6508,"y":3331.3657},"symbol":{"type":"marker","style":"circle","color":[255,128,128],"size":12},"fields":{"里程":"K0+145.475","点类型":"","标高":2.01}}]}');

//      map.highlightMultiSearchResult({featureId: "道路_0"});

//      map.removeLayer({label: "cad111"});
//      map.stopTrackPlayback();
//      map.startTrackPlayback({trackPoints:[{x: 104.023, y: 30.577, time: "2017/11/24 08:00:00"}, {x: 104.002, y: 30.565, time: "2017/11/24 08:00:05"}], autoStart: true, loop: true, showTrackPoints: true});
//     map.findFeature({layerName: "trackPlayback", ids: ["1"]});

    // map.addLayer({type: "ChengDiDynamic", url: "1501241008970639", label: "cad111", showSublayers: false});
    // map.deleteAllOverlays();

    // map.showTopToolbarButton("历史演变");

    // map.hideDoubleMap();

    // map.showTopToolbar();

    // map.addOverlays('{"showPopup":true,"defaultSymbol":{"type":"marker","style":"circle","color":"red","alpha":0.8,"size":7,"outline":{"color":"white"}},"overlays":[{"type":"CADPile","geometry":{"x":"-2306.4187","y":"3261.5966"},"fields":{"里程":"-2.082","点类型":"起点","标高":"3.94"}},{"type":"CADPile","geometry":{"x":"-2224.4326","y":"3313.7568"},"fields":{"里程":"95.475","点类型":"圆缓点","标高":"4.03"}},{"type":"CADPile","geometry":{"x":"-2177.6508","y":"3331.3657"},"fields":{"里程":"145.475","点类型":"","标高":"2.01"}},{"type":"CADPile","geometry":{"x":"-2129.801","y":"3345.7508"},"fields":{"里程":"195.475","点类型":"缓圆点","标高":"-0.94"}},{"type":"CADPile","geometry":{"x":"-2017.1286","y":"3336.9739"},"fields":{"里程":"310.049","点类型":"圆缓点","标高":"-7.61"}},{"type":"CADPile","geometry":{"x":"-1972.0836","y":"3315.3527"},"fields":{"里程":"360.049","点类型":"缓直点","标高":"-9.16"}},{"type":"CADPile","geometry":{"x":"-1937.5042","y":"3298.0096"},"fields":{"里程":"396.957","点类型":"直缓点","标高":"-9.27"}},{"type":"CADPile","geometry":{"x":"-1895.0941","y":"3275.0431"},"fields":{"里程":"446.957","点类型":"缓圆点","标高":"-9.12"}},{"type":"CADPile","geometry":{"x":"-1771.4965","y":"3228.6583"},"fields":{"里程":"579.169","点类型":"圆缓点","标高":"-9.04"}},{"type":"CADPile","geometry":{"x":"-1722.9416","y":"3216.7361"},"fields":{"里程":"629.169","点类型":"缓直点","标高":"-9.19"}},{"type":"CADPile","geometry":{"x":"-1667.2311","y":"3203.758"},"fields":{"里程":"686.371","点类型":"直缓点","标高":"-9.36"}},{"type":"CADPile","geometry":{"x":"-1618.701","y":"3191.7397"},"fields":{"里程":"736.371","点类型":"缓圆点","标高":"-8.96"}},{"type":"CADPile","geometry":{"x":"-1570.8256","y":"3176.273"},"fields":{"里程":"786.697","点类型":"圆缓点","标高":"-6.9"}},{"type":"CADPile","geometry":{"x":"-1524.4368","y":"3157.6265"},"fields":{"里程":"836.697","点类型":"缓直点","标高":"-3.93"}},{"type":"CADPile","geometry":{"x":"-1367.898","y":"3092.1643"},"fields":{"里程":"1006.373","点类型":"直缓点","标高":"3.8"}},{"type":"CADPile","geometry":{"x":"-1335.8812","y":"3078.0379"},"fields":{"里程":"1041.373","点类型":"缓圆点","标高":"3.65"}},{"type":"CADPile","geometry":{"x":"-1306.1174","y":"3061.3372"},"fields":{"里程":"1075.52","点类型":"圆缓点","标高":"3.48"}},{"type":"CADPile","geometry":{"x":"-1277.3767","y":"3041.3723"},"fields":{"里程":"1110.52","点类型":"缓直点","标高":"3.35"}},{"type":"CADPile","geometry":{"x":"-1179.9088","y":"2970.8169"},"fields":{"里程":"1230.845","点类型":"终点","标高":"3.32"}}]}');

    // map.removeDoubleMapLayer({mapIndex: "1", label: "道路交通设施"});
    // map.removeDoubleMapLayer({mapIndex: "2", label: "cad111"});
    // map.showTopToolbar();
    // map.showBottomToolbar();
    map.showBottomToolbarButton("发布段");
    map.showBottomToolbarButton("摄像机");
    map.showTopToolbarButton("保存");

  }

  function Test3ClickHandler() {
//      map.addSwipeLayer({
//        layerType: "swipe",
//        layer: {label: "111", url: "http://128.64.151.222:6080/arcgis/rest/services/CADServices/p20170703144514_c20170703144514/MapServer"}
//      });

    // map.clearMultiSearchResult();

  }

  function compareCad() {
    console.log("CompareCAD");
  }

  function goBack() {
    console.log("GoBack");
  }

  function showHistory() {
    console.log("History");
  }

  function showGisDeviceInfo(type, id) {
    console.log(type, id);
  }

  function showGisDeviceDetailInfo(result) {
    console.log(result);
  }

  function mapFeatureClicked(type, id) {
    console.log(type, id);
    map.startTrackPlayback({
      trackPoints: [{x: 104.023, y: 30.577, time: ""}, {
        x: 104.002,
        y: 30.565,
        time: ""
      }, {x: 103.969, y: 30.56, time: ""}, {x: 103.907, y: 30.536, time: ""}]
    });
  }

  function getOverlays(results) {
    console.log(results);
  }

  function startAddCross(data) {
    console.log(data);
  }

  function addCross(data) {
    console.log(data);
  }

  function StopAddCross() {
    console.log("Stop");
  }

  function RouteByCrossInitFinish() {
    map.showRouteByCross({crossIds:["51012211500109","51012200100102","51012200100112","51012200100123","51012200100134","51012212000438"]});
  }

  function showOD(data) {
    map.showOD(data);
  }
</script>


</body>
</html>